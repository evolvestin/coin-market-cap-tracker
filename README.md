# Telegram бот для отслеживания курса криптовалют

## Описание проекта
Этот проект представляет собой Telegram бота, который отслеживает курс криптовалют и уведомляет пользователя, 
если цена конкретной валюты выходит за установленные пороговые значения. 
Бот взаимодействует с базой данных PostgreSQL и CoinMarketCap API для получения актуальных данных о ценах.

## Подготовка к запуску

### 1. Клонирование репозитория
Сначала необходимо клонировать репозиторий с вашим кодом на локальный компьютер:

```bash
git clone <URL_вашего_репозитория>
cd <название_папки_репозитория>
```
### 2. Создание .env файла
Создайте файл .env в корневой папке проекта и добавьте в него следующие строки:
```
DB_USER=<юзернейм пользователя базы PostgreSQL>
DB_PASS=<пароль пользователя базы PostgreSQL>
TEST_USER_ID=<Telegram ID пользователя для выполнения тестов>
COINMARKETCAP_API_KEY=<ключ API от сервиса CoinMarketCap>
TELEGRAM_API_TOKEN=<ключ API бота в Telegram>
DATABASE_URL=postgresql://<юзернейм пользователя базы>:<пароль пользователя базы>@localhost/test_coin_market_cap
```
Замените значения на ваши реальные данные.

### 2. Создание бота в Telegram через BotFather

1. В Telegram найдите и откройте `BotFather`.
2. Отправьте команду `/newbot` для создания нового бота.
3. Следуйте инструкциям:
   - Укажите имя для бота (например, `Crypto Price Tracker`).
   - Укажите уникальное имя пользователя, заканчивающееся на `bot` (например, `CryptoPriceBot`).
4. Получите API токен, который будет выдан BotFather.
5. Сохраните API токен и добавьте его в файл `.env` в строку `TELEGRAM_API_TOKEN`.

### 3. Установка Docker и Docker Compose
Убедитесь, что на вашем компьютере установлены Docker и Docker Compose. 
Для установки следуйте официальной документации [Docker](https://docs.docker.com/) 
и документации [Docker Compose](https://docs.docker.com/compose/).

Перед запуском бота необходимо создать базу данных, с которой он будет работать.

### 4. Запуск Docker Compose
В корневой папке проекта выполните команду:
```bash
docker-compose up --build
```
Эта команда создаст и запустит контейнеры для бота и базы данных PostgreSQL.

### 5. Подключение к PostgreSQL
После того как контейнер с базой данных запущен, нужно подключиться к PostgreSQL. 
Это можно сделать как через командную строку, так и через любые 
графические интерфейсы (например, pgAdmin или DBeaver). Здесь показан вариант с использованием командной строки.

Чтобы подключиться к базе данных PostgreSQL, выполните команду:
```bash
docker exec -it database_postgres psql -U postgres
```
После успешного подключения к PostgreSQL создайте базу данных, которая будет использоваться ботом. 
Для этого в командной строке PostgreSQL выполните следующую команду:
```sql
CREATE DATABASE test_coin_market_cap;
```
Чтобы выйти из интерфейса командной строки PostgreSQL, введите:
```bash
\q
```

### 6. Перезапуск контейнеров после создания базы данных
После того как вы создали базу данных test_coin_market_cap, необходимо перезапустить контейнеры, 
чтобы бот смог подключиться к базе данных и начать свою работу.
```bash
docker-compose restart
```

#### После перезапуска контейнеров убедитесь, что бот работает, отправив команду /start в Telegram. 
#### Если все настройки выполнены правильно, бот должен ответить приветственным сообщением

## Команды бота
После успешного запуска бота, он будет доступен в Telegram по вашему `TELEGRAM_API_TOKEN`. 

Бот поддерживает следующие команды:

### `/start` и `/help`
Эти команды используются для приветствия. 
При вызове любой из них бот также автоматически настроит доступные команды для пользователя 
(Специальное меню команд, для удобства).

### `/set_threshold`
Эта команда позволяет установить пороговые значения для определённой криптовалюты. 
Если цена выйдет за эти пороги, бот уведомит вас.

Пример использования:
```
/set_threshold BTC 30000.0 40000.3
```
Где `BTC` — это тикер криптовалюты, `30000.0` — минимальное значение, а `40000.3` — максимальное значение.

### `/delete_threshold`
Эта команда удаляет установленное пороговое значение для конкретной криптовалюты.

Пример использования:
```
/delete_threshold BTC
```
Где `BTC` — это тикер криптовалюты, для которой нужно удалить пороговое значение.

### `/delete_all_thresholds`
Эта команда удаляет все установленные пороговые значения для текущего пользователя.

Пример использования:
```
/delete_all_thresholds
```
